# 死锁

## 概念

两个或两个以上的线程在执行过程中, 因争夺资源而造成的一种互相等待的现象, 若无外力作用, 它们都将无法推进下去.

## 解决

### 加锁顺序

线程按照一定的顺序加锁

```text
Thread 1:
  lock A 
  lock B

Thread 2:
   wait for A
   lock C (when A locked)

Thread 3:
   wait for A
   wait for B
   wait for C
```

如果一个线程（比如线程3）需要一些锁, 那么它必须按照确定的顺序获取锁. 它只有获得了从顺序上排在前面的锁之后, 才能获取后面的锁.

按照顺序加锁是一种有效的死锁预防机制. 但这种方式需要你事先知道所有可能会用到的锁(并对这些锁做适当的排序), 但总有些时候是无法预知的.

### 加锁时限

线程尝试获取锁的时候加上一定的时限, 超过时限则放弃对该锁的请求, 并释放自己占有的锁

### 死锁检测
